<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legacy Guardians - 开场动画</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #000;
            color: white;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        .intro-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .intro-image {
            width:100%;
            height:100%;
            object-fit: contain; 
            opacity: 0;
            transition: opacity 1s ease-in-out;
            position: absolute;
        }
        .intro-image.active {
            opacity: 1;
        }

        /* --- 这是新增的部分 --- */
        /* 透明的可点击区域 */
        .clickable-area {
            position: absolute;
            top: 0;
            height: 100%;
            width: 30%; /* 覆盖屏幕左右各30%的区域 */
            z-index: 50; /* 在图片之上，在HTML按钮之下 */
            cursor: pointer;
            /* background-color: rgba(255, 0, 0, 0.2); */ /* 取消注释这行可以看到点击区域，方便调试 */
        }
        #image-prev-area {
            left: 0;
        }
        #image-next-area {
            right: 0;
        }
        /* --- 新增结束 --- */

        .nav-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 80px;
            height: 80px;
            background-color: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 3em;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.3s, transform 0.3s;
            z-index: 100;
        }
        .nav-button:hover {
            background-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-50%) scale(1.05);
        }
        #prev-btn { left: 20px; }
        #next-btn { right: 20px; }
        #skip-button {
            position: absolute;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            background-color: rgba(155, 89, 182, 0.7);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            z-index: 100;
        }
        #skip-button:hover {
            background-color: rgba(155, 89, 182, 0.9);
        }
    </style>
</head>
<body>
    <div class="intro-container" id="intro-container">
        <div id="image-prev-area" class="clickable-area"></div>
        <div id="image-next-area" class="clickable-area"></div>

        <button id="prev-btn" class="nav-button">&#x2190;</button>
        <button id="next-btn" class="nav-button">&#x2192;</button>
        <button id="skip-button">跳过开场动画</button>
    </div>

    <script>
        const imageCount = 14;
        const images = [];
        let currentImageIndex = 0;
        const introContainer = document.getElementById('intro-container');

        // 获取所有按钮和点击区域
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const skipBtn = document.getElementById('skip-button');
        const imagePrevArea = document.getElementById('image-prev-area');
        const imageNextArea = document.getElementById('image-next-area');

        // 预加载图片
        for (let i = 1; i <= imageCount; i++) {
            const img = new Image();
            img.src = `/static/image${i}.png`;
            img.className = 'intro-image';
            introContainer.appendChild(img);
            images.push(img);
        }

        function showImage(index) {
            images.forEach((img, idx) => {
                img.classList.toggle('active', idx === index);
            });
            currentImageIndex = index;
            updateNavButtons();
        }

        // --- 这是修改的核心逻辑 ---
        function updateNavButtons() {
            // 定义哪些图片自带按钮，需要激活透明点击区
            //const imagesWithBuiltInArrows = [1, 2, 3, 4, 5, 6, 7]; // 图片索引 (从0开始)

            // 检查当前图片是否应该显示透明点击区
            const showClickableAreas = imagesWithBuiltInArrows.includes(currentImageIndex);

            // 控制透明点击区的显示/隐藏
            imagePrevArea.style.display = showClickableAreas ? 'block' : 'none';
            imageNextArea.style.display = showClickableAreas ? 'block' : 'none';

            // 控制HTML按钮的显示/隐藏
            // 只有在不显示透明点击区，并且符合翻页逻辑时，才显示HTML按钮
            prevBtn.style.display = (!showClickableAreas && currentImageIndex > 0) ? 'flex' : 'none';
            nextBtn.style.display = (!showClickableAreas && currentImageIndex < imageCount - 1) ? 'flex' : 'none';

            // 跳过按钮始终显示
            skipBtn.style.display = 'block';
        }

        function nextImage() {
            if (currentImageIndex < imageCount - 1) {
                showImage(currentImageIndex + 1);
            } else {
                // 建议直接跳转到第一关
                window.location.href = '/game/part1';
            }
        }

        function prevImage() {
            if (currentImageIndex > 0) {
                showImage(currentImageIndex - 1);
            }
        }

        // --- 为所有导航元素绑定事件 ---
        prevBtn.addEventListener('click', prevImage);
        nextBtn.addEventListener('click', nextImage);
        imagePrevArea.addEventListener('click', prevImage);
        imageNextArea.addEventListener('click', nextImage);

        skipBtn.addEventListener('click', () => {
            window.location.href = '/game/part1';
        });

        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowRight') nextImage();
            else if (e.key === 'ArrowLeft') prevImage();
            else if (e.key === 'Escape') window.location.href = '/game/part1';
        });

        // 初始显示第一张图片
        showImage(0);
    </script>
</body>
</html>